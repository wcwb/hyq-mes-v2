# é¡¶éƒ¨èœå•æ å¢å¼ºéœ€æ±‚æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è§ˆ

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**æœ€åæ›´æ–°**: 2025å¹´6æœˆ  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ  
**é¡¹ç›®**: HYQ MES V2 ç³»ç»Ÿç•Œé¢å¢å¼º

---

## ğŸ¯ ä¸€ã€é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡

### 1.1 èƒŒæ™¯æè¿°

åœ¨å½“å‰çš„åº”ç”¨å¸ƒå±€åŸºç¡€ä¸Šï¼Œå¢å¼ºé¡¶éƒ¨èœå•æ åŠŸèƒ½ï¼Œæå‡ç”¨æˆ·æ“ä½œä½“éªŒå’Œç•Œé¢ç¾è§‚åº¦ã€‚å½“å‰é¡¹ç›®å·²æœ‰åŸºç¡€çš„AppHeaderç»„ä»¶å’Œä¾§è¾¹æ å¸ƒå±€ï¼Œéœ€è¦åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡ŒåŠŸèƒ½æ‰©å±•å’ŒUIä¼˜åŒ–ã€‚

### 1.2 æ ¸å¿ƒç›®æ ‡

- **æå‡ç”¨æˆ·æ•ˆç‡**ï¼šé€šè¿‡Tabå¯¼èˆªå’Œå…¨å±€æœç´¢å‡å°‘é¡µé¢è·³è½¬
- **ä¼˜åŒ–ç•Œé¢å¸ƒå±€**ï¼šç»Ÿä¸€é¡¶éƒ¨æ“ä½œåŒºåŸŸï¼Œæä¾›æ›´å¥½çš„è§†è§‰ä½“éªŒ
- **å¢å¼ºåŠŸèƒ½é›†æˆ**ï¼šæ•´åˆç°æœ‰ç»„ä»¶ï¼Œæä¾›ä¸€è‡´çš„äº¤äº’ä½“éªŒ
- **æ”¯æŒå¤šåœºæ™¯**ï¼šé€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯ä¸åŒä½¿ç”¨åœºæ™¯

### 1.3 æˆåŠŸæŒ‡æ ‡

- é¡µé¢åˆ‡æ¢æ•ˆç‡æå‡30%
- ç”¨æˆ·æŸ¥æ‰¾åŠŸèƒ½æ—¶é—´å‡å°‘50%
- ç•Œé¢ä¸€è‡´æ€§è¯„åˆ†è¾¾åˆ°90%ä»¥ä¸Š
- ç§»åŠ¨ç«¯å¯ç”¨æ€§è¯„åˆ†è¾¾åˆ°85%ä»¥ä¸Š

---

## ğŸ—ï¸ äºŒã€æŠ€æœ¯æ¶æ„ä¸é€‰å‹

### 2.1 æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**ï¼šVue 3 + Composition API + TypeScript
- **é¡µé¢æ¡†æ¶**ï¼šInertia.js
- **UIç»„ä»¶åº“**ï¼šreka-uiï¼ˆç±»shadcnè®¾è®¡ç³»ç»Ÿï¼‰
- **æ ·å¼ç³»ç»Ÿ**ï¼šTailwind CSS
- **å›¾æ ‡åº“**ï¼šlucide-vue-next
- **çŠ¶æ€ç®¡ç†**ï¼šVue 3 Composables + LocalStorage
- **æƒé™ç³»ç»Ÿ**ï¼šSpatie Permissionï¼ˆç°æœ‰ï¼‰

### 2.2 æ¶æ„åŸåˆ™

1. **æ¸è¿›å¼å¢å¼º**ï¼šåœ¨ç°æœ‰åŸºç¡€ä¸Šé€æ­¥æ·»åŠ åŠŸèƒ½
2. **ç»„ä»¶å¤ç”¨**ï¼šæœ€å¤§åŒ–åˆ©ç”¨ç°æœ‰ç»„ä»¶å’Œè®¾è®¡ç³»ç»Ÿ
3. **æ€§èƒ½ä¼˜å…ˆ**ï¼šç¡®ä¿æ–°åŠŸèƒ½ä¸å½±å“ç°æœ‰æ€§èƒ½
4. **å¯è®¿é—®æ€§**ï¼šéµå¾ªWCAG 2.1 AAæ ‡å‡†
5. **å›½é™…åŒ–æ”¯æŒ**ï¼šä¸ç°æœ‰i18nç³»ç»Ÿé›†æˆ

---

## ğŸ¨ ä¸‰ã€ç•Œé¢è®¾è®¡è§„èŒƒ

### 3.1 å¸ƒå±€ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [â˜°] [ğŸ”æœç´¢æ ]                         [ğŸŒè¯­è¨€] [ğŸŒ™ä¸»é¢˜] [ğŸ‘¤ç”¨æˆ·] â”‚
â”‚  å·¦ä¾§åŠŸèƒ½åŒº                                        å³ä¾§å·¥å…·åŒº    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [é¦–é¡µ] [è®¢å•ç®¡ç†] [ç”Ÿäº§ç®¡ç†] [è´¨é‡æ£€æµ‹] [è®¾ç½®] +              [Ã—] â”‚
â”‚  Tabå¯¼èˆªåŒºï¼ˆç±»ä¼¼æµè§ˆå™¨æ ‡ç­¾ï¼‰                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 è§†è§‰è®¾è®¡è§„èŒƒ

#### å°ºå¯¸è§„èŒƒ
- **é¡¶éƒ¨èœå•æ é«˜åº¦**ï¼š`h-14` (56px)
- **Tabå¯¼èˆªé«˜åº¦**ï¼š`h-10` (40px)
- **ç»„ä»¶é—´è·**ï¼š`gap-2` (8px)
- **å†…è¾¹è·**ï¼š`px-4` (16px)

#### é¢œè‰²ç³»ç»Ÿ
- ä½¿ç”¨ç°æœ‰çš„è®¾è®¡token
- æ”¯æŒæµ…è‰²/æ·±è‰²ä¸»é¢˜è‡ªåŠ¨é€‚é…
- é«˜å¯¹æ¯”åº¦æ¨¡å¼æ”¯æŒ

#### åŠ¨ç”»æ•ˆæœ
- **Tabåˆ‡æ¢**ï¼š`transition-all duration-200 ease-in-out`
- **æœç´¢æ å±•å¼€**ï¼š`transition-width duration-300 ease-out`
- **ä¸»é¢˜åˆ‡æ¢**ï¼š`transition-colors duration-200`

### 3.3 å“åº”å¼è®¾è®¡

#### æ¡Œé¢ç«¯ï¼ˆlgåŠä»¥ä¸Šï¼‰
- å®Œæ•´åŠŸèƒ½å¸ƒå±€
- æ‰€æœ‰å·¥å…·æ ç»„ä»¶å¯è§
- Tabå¯¼èˆªå®Œå…¨å±•å¼€

#### ç§»åŠ¨ç«¯ï¼ˆlgä»¥ä¸‹ï¼‰
- ç®€åŒ–å¸ƒå±€ï¼Œå·¥å…·æ æ”¶çº³åˆ°Sheetä¸­
- æœç´¢åŠŸèƒ½ä¿ç•™ä½†æ ·å¼è°ƒæ•´
- Tabå¯¼èˆªæ”¯æŒæ»‘åŠ¨

---

## ğŸš€ å››ã€æ ¸å¿ƒåŠŸèƒ½éœ€æ±‚ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰

### 4.1 P0 - åŸºç¡€å¸ƒå±€é‡æ„

#### 4.1.1 é¡¶éƒ¨èœå•æ ä¸»ç»„ä»¶

**ä¾èµ–å…³ç³»**ï¼šæ—   
**å®æ–½ä¼˜å…ˆçº§**ï¼šæœ€é«˜  

```vue
<!-- TopMenuBar.vue -->
<template>
  <header class="top-menu-bar border-b bg-background">
    <!-- æ¡Œé¢ç«¯å¸ƒå±€ -->
    <div class="hidden lg:flex w-full items-center justify-between px-4 h-14">
      <!-- å·¦ä¾§åŠŸèƒ½åŒº -->
      <div class="flex items-center gap-2">
        <SidebarTrigger />
        <SearchBar />
      </div>
      
      <!-- å³ä¾§å·¥å…·åŒº -->
      <div class="flex items-center gap-2">
        <LanguageToggle />
        <ThemeToggle />
        <UserMenu />
      </div>
    </div>

    <!-- ç§»åŠ¨ç«¯å¸ƒå±€ -->
    <div class="flex lg:hidden w-full items-center justify-between px-4 h-14">
      <SidebarTrigger />
      <MobileToolsMenu />
    </div>

    <!-- Tabå¯¼èˆªåŒº -->
    <TabNavigation />
  </header>
</template>
```

#### 4.1.2 ç°æœ‰ç»„ä»¶é›†æˆ

**ä¾èµ–å…³ç³»**ï¼šåŸºç¡€å¸ƒå±€  
**å®æ–½ä¼˜å…ˆçº§**ï¼šé«˜  

- **SidebarTrigger**ï¼šç›´æ¥ä½¿ç”¨ç°æœ‰ç»„ä»¶
- **LanguageSwitcher**ï¼šç®€åŒ–ä¸ºLanguageToggle
- **AppearanceTabs**ï¼šç®€åŒ–ä¸ºThemeToggle
- **UserMenuContent**ï¼šä¿æŒç°æœ‰åŠŸèƒ½

### 4.2 P0 - åŸºç¡€æœç´¢åŠŸèƒ½

#### 4.2.1 æœç´¢æ ç»„ä»¶

**ä¾èµ–å…³ç³»**ï¼šåŸºç¡€å¸ƒå±€  
**å®æ–½ä¼˜å…ˆçº§**ï¼šé«˜  

```vue
<!-- SearchBar.vue -->
<script setup lang="ts">
import { useGlobalSearch } from '@/composables/useGlobalSearch';
import { useTopMenuPermissions } from '@/composables/useTopMenuPermissions';

const { canAccessSearch } = useTopMenuPermissions();
const { 
  searchQuery, 
  searchResults, 
  isSearchOpen, 
  performGlobalSearch 
} = useGlobalSearch();
</script>

<template>
  <div v-if="canAccessSearch" class="relative">
    <!-- æœç´¢è§¦å‘å™¨ -->
    <Button
      variant="outline"
      class="w-64 justify-start text-muted-foreground"
      @click="openSearch"
    >
      <Search class="mr-2 h-4 w-4" />
      æœç´¢é¡µé¢ã€è®¢å•ã€äº§å“...
      <kbd class="ml-auto text-xs">âŒ˜K</kbd>
    </Button>

    <!-- æœç´¢å¯¹è¯æ¡† -->
    <CommandDialog v-model:open="isSearchOpen">
      <CommandInput 
        v-model="searchQuery"
        placeholder="è¾“å…¥æœç´¢å†…å®¹..."
      />
      <CommandList>
        <CommandEmpty>æœªæ‰¾åˆ°ç›¸å…³ç»“æœ</CommandEmpty>
        <CommandGroup 
          v-for="group in groupedResults" 
          :key="group.category"
          :heading="group.title"
        >
          <CommandItem
            v-for="item in group.items"
            :key="item.id"
            @select="navigateToResult(item)"
          >
            <component :is="item.icon" class="mr-2 h-4 w-4" />
            {{ item.title }}
          </CommandItem>
        </CommandGroup>
      </CommandList>
    </CommandDialog>
  </div>
</template>
```

#### 4.2.2 æœç´¢åŠŸèƒ½å®ç°

**ä¾èµ–å…³ç³»**ï¼šæœç´¢æ ç»„ä»¶ã€æƒé™ç³»ç»Ÿ  
**å®æ–½ä¼˜å…ˆçº§**ï¼šé«˜  

```typescript
// composables/useGlobalSearch.ts
export function useGlobalSearch() {
  const searchQuery = useDebouncedRef('', 300);
  const searchResults = ref<SearchResult[]>([]);
  const isSearchOpen = ref(false);
  const searchHistory = useLocalStorage<string[]>('search-history', []);

  // åŸºç¡€æœç´¢å®ç°
  const performGlobalSearch = async (query: string): Promise<SearchResult[]> => {
    if (!query.trim()) return [];
    
    try {
      // 1. æœç´¢é¡µé¢å’ŒåŠŸèƒ½ï¼ˆæœ¬åœ°ï¼‰
      const pageResults = await searchPages(query);
      
      // 2. æœç´¢æ•°æ®ï¼ˆAPIè°ƒç”¨ï¼‰
      const dataResults = await searchData(query);
      
      const allResults = [...pageResults, ...dataResults];
      
      // æ·»åŠ åˆ°æœç´¢å†å²
      if (!searchHistory.value.includes(query)) {
        searchHistory.value.unshift(query);
        searchHistory.value = searchHistory.value.slice(0, 10);
      }
      
      return allResults;
    } catch (error) {
      console.error('æœç´¢å¤±è´¥:', error);
      return [];
    }
  };

  return {
    searchQuery,
    searchResults,
    isSearchOpen,
    searchHistory,
    performGlobalSearch,
  };
}
```

### 4.3 P1 - Tabå¯¼èˆªç³»ç»Ÿ

#### 4.3.1 Tabå¯¼èˆªæ ¸å¿ƒç»„ä»¶

**ä¾èµ–å…³ç³»**ï¼šåŸºç¡€å¸ƒå±€ã€è·¯ç”±ç³»ç»Ÿ  
**å®æ–½ä¼˜å…ˆçº§**ï¼šä¸­é«˜  

```typescript
// types/navigation.ts
export interface TabItem {
  id: string;
  title: string;
  href: string;
  isActive: boolean;
  isDirty?: boolean;
  isClosable?: boolean;
  icon?: LucideIcon;
  lastAccessed?: number;
}

// composables/useTabNavigation.ts
export function useTabNavigation() {
  const tabs = ref<TabItem[]>([]);
  const activeTabId = ref<string | null>(null);
  const maxTabs = ref(12);

  const addTab = (tab: Omit<TabItem, 'id'>) => {
    // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
    const existingTab = tabs.value.find(t => t.href === tab.href);
    if (existingTab) {
      switchTab(existingTab.id);
      return;
    }

    // æ£€æŸ¥æ•°é‡é™åˆ¶
    if (tabs.value.length >= maxTabs.value) {
      // ç§»é™¤æœ€ä¹…æœªè®¿é—®çš„Tab
      const oldestTab = tabs.value
        .filter(t => t.isClosable !== false)
        .sort((a, b) => (a.lastAccessed || 0) - (b.lastAccessed || 0))[0];
      
      if (oldestTab) {
        removeTab(oldestTab.id);
      }
    }

    const newTab: TabItem = {
      ...tab,
      id: generateTabId(),
      lastAccessed: Date.now(),
    };

    tabs.value.push(newTab);
    switchTab(newTab.id);
  };

  const removeTab = (tabId: string) => {
    const index = tabs.value.findIndex(t => t.id === tabId);
    if (index === -1) return;

    const wasActive = tabs.value[index].isActive;
    tabs.value.splice(index, 1);

    // å¦‚æœå…³é—­çš„æ˜¯å½“å‰Tabï¼Œåˆ‡æ¢åˆ°ç›¸é‚»Tab
    if (wasActive && tabs.value.length > 0) {
      const nextIndex = Math.min(index, tabs.value.length - 1);
      switchTab(tabs.value[nextIndex].id);
    }
  };

  const switchTab = (tabId: string) => {
    tabs.value.forEach(tab => {
      tab.isActive = tab.id === tabId;
      if (tab.isActive) {
        tab.lastAccessed = Date.now();
      }
    });
    activeTabId.value = tabId;
  };

  return {
    tabs: readonly(tabs),
    activeTabId: readonly(activeTabId),
    addTab,
    removeTab,
    switchTab,
  };
}
```

#### 4.3.2 Inertia.jsè·¯ç”±é›†æˆ

**ä¾èµ–å…³ç³»**ï¼šTabå¯¼èˆªæ ¸å¿ƒã€Inertia.js  
**å®æ–½ä¼˜å…ˆçº§**ï¼šä¸­é«˜  

```typescript
// composables/useInertiaTabNavigation.ts
import { router, usePage } from '@inertiajs/vue3';
import { route } from 'ziggy-js';

export function useInertiaTabNavigation() {
  const page = usePage();
  const { addTab, switchTab } = useTabNavigation();

  const navigateToTab = (tabHref: string) => {
    router.get(tabHref, {}, {
      preserveState: true,
      preserveScroll: true,
      onSuccess: () => {
        updateActiveTab(tabHref);
      }
    });
  };

  const openInNewTab = (routeName: string, params: Record<string, any> = {}) => {
    const href = route(routeName, params);
    const tabItem: Omit<TabItem, 'id'> = {
      title: getPageTitle(routeName, params),
      href,
      isActive: false,
      isClosable: true,
      icon: getRouteIcon(routeName),
    };
    
    addTab(tabItem);
    navigateToTab(href);
  };

  // é¡µé¢æ ‡é¢˜æ˜ å°„
  const getPageTitle = (routeName: string, params: Record<string, any>) => {
    const titleMap: Record<string, string> = {
      'dashboard': 'ä»ªè¡¨æ¿',
      'orders.index': 'è®¢å•ç®¡ç†',
      'orders.show': `è®¢å•è¯¦æƒ… #${params.order}`,
      'products.index': 'äº§å“ç®¡ç†',
      'customers.index': 'å®¢æˆ·ç®¡ç†',
      'settings.profile': 'ä¸ªäººè®¾ç½®',
    };
    
    return titleMap[routeName] || routeName;
  };

  return {
    navigateToTab,
    openInNewTab,
    currentUrl: computed(() => page.url),
  };
}
```

### 4.4 P2 - æƒé™æ§åˆ¶é›†æˆ

#### 4.4.1 æƒé™æ£€æŸ¥ç»„åˆå¼å‡½æ•°

**ä¾èµ–å…³ç³»**ï¼šç°æœ‰æƒé™ç³»ç»Ÿ  
**å®æ–½ä¼˜å…ˆçº§**ï¼šä¸­  

```typescript
// composables/useTopMenuPermissions.ts
export function useTopMenuPermissions() {
  const { user } = useAuth();
  const { currentTeam } = useTeam();
  
  const canAccessSearch = computed(() => {
    // æ ¹æ®ç”¨æˆ·æƒé™å†³å®šæ˜¯å¦æ˜¾ç¤ºæœç´¢åŠŸèƒ½
    return user.value?.hasPermissionInTeam(
      currentTeam.value?.id, 
      'view_global_search'
    ) ?? true; // é»˜è®¤å…è®¸æœç´¢
  });
  
  const canManageTeam = computed(() => {
    return user.value?.hasPermissionInTeam(
      currentTeam.value?.id, 
      'manage_team_members'
    ) ?? false;
  });
  
  const availableModules = computed(() => {
    const modules = ['orders', 'products', 'customers', 'reports'];
    return modules.filter(module => 
      user.value?.hasPermissionInTeam(
        currentTeam.value?.id, 
        `view_${module}`
      ) ?? false
    );
  });
  
  const canAccessModule = (module: string) => {
    return user.value?.hasPermissionInTeam(
      currentTeam.value?.id, 
      `view_${module}`
    ) ?? false;
  };
  
  return {
    canAccessSearch,
    canManageTeam,
    availableModules,
    canAccessModule,
  };
}
```

---

## ğŸ”§ äº”ã€é«˜çº§åŠŸèƒ½éœ€æ±‚

### 5.1 P2 - æœç´¢åŠŸèƒ½å¢å¼º

#### 5.1.1 å¤šæ•°æ®æºæœç´¢

**ä¾èµ–å…³ç³»**ï¼šåŸºç¡€æœç´¢åŠŸèƒ½  
**å®æ–½ä¼˜å…ˆçº§**ï¼šä¸­  

```typescript
// composables/useAdvancedSearch.ts
export interface SearchProvider {
  name: string;
  search: (query: string) => Promise<SearchResult[]>;
  icon: LucideIcon;
  enabled: boolean;
}

export function useAdvancedSearch() {
  const { canAccessModule } = useTopMenuPermissions();
  
  // åŠ¨æ€æœç´¢æä¾›è€…ï¼ˆåŸºäºæƒé™ï¼‰
  const searchProviders = computed<SearchProvider[]>(() => [
    {
      name: 'pages',
      search: searchPages,
      icon: FileText,
      enabled: true,
    },
    {
      name: 'orders',
      search: searchOrders,
      icon: ShoppingCart,
      enabled: canAccessModule('orders'),
    },
    {
      name: 'products',
      search: searchProducts,
      icon: Package,
      enabled: canAccessModule('products'),
    },
    {
      name: 'customers',
      search: searchCustomers,
      icon: Users,
      enabled: canAccessModule('customers'),
    },
  ].filter(provider => provider.enabled));

  const performGlobalSearch = async (query: string): Promise<SearchResult[]> => {
    if (!query.trim()) return [];
    
    try {
      // å¹¶è¡Œæœç´¢æ‰€æœ‰å¯ç”¨çš„æ•°æ®æº
      const searchPromises = searchProviders.value.map(provider => 
        provider.search(query).catch(() => [])
      );
      
      const results = await Promise.all(searchPromises);
      return results.flat();
    } catch (error) {
      console.error('æœç´¢å¤±è´¥:', error);
      return [];
    }
  };

  return {
    searchProviders,
    performGlobalSearch,
  };
}
```

### 5.2 P2 - Tabå¯¼èˆªå¢å¼ºåŠŸèƒ½

#### 5.2.1 Tabæ‹–æ‹½é‡æ’åº

**ä¾èµ–å…³ç³»**ï¼šTabå¯¼èˆªæ ¸å¿ƒ  
**å®æ–½ä¼˜å…ˆçº§**ï¼šä¸­  

```vue
<!-- TabDragHandler.vue -->
<script setup lang="ts">
import { useSortable } from '@vueuse/integrations/useSortable';

const props = defineProps<{
  tabs: TabItem[];
}>();

const emit = defineEmits<{
  reorder: [fromIndex: number, toIndex: number];
}>();

const tabsContainer = ref<HTMLElement>();

const { start, stop } = useSortable(tabsContainer, props.tabs, {
  animation: 200,
  onUpdate: (e) => {
    emit('reorder', e.oldIndex!, e.newIndex!);
  },
});

onMounted(() => start());
onUnmounted(() => stop());
</script>

<template>
  <div ref="tabsContainer" class="flex">
    <slot />
  </div>
</template>
```

#### 5.2.2 Tabå³é”®èœå•

**ä¾èµ–å…³ç³»**ï¼šTabå¯¼èˆªæ ¸å¿ƒ  
**å®æ–½ä¼˜å…ˆçº§**ï¼šä¸­  

```vue
<!-- TabContextMenu.vue -->
<script setup lang="ts">
const props = defineProps<{
  tab: TabItem;
}>();

const emit = defineEmits<{
  close: [tabId: string];
  closeOthers: [tabId: string];
  closeAll: [];
  duplicate: [tab: TabItem];
}>();

const menuItems = computed(() => [
  {
    label: 'å…³é—­æ ‡ç­¾',
    action: () => emit('close', props.tab.id),
    disabled: !props.tab.isClosable,
    shortcut: 'Ctrl+W',
  },
  {
    label: 'å…³é—­å…¶ä»–æ ‡ç­¾',
    action: () => emit('closeOthers', props.tab.id),
  },
  {
    label: 'å…³é—­æ‰€æœ‰æ ‡ç­¾',
    action: () => emit('closeAll'),
  },
  { type: 'separator' },
  {
    label: 'å¤åˆ¶æ ‡ç­¾',
    action: () => emit('duplicate', props.tab),
  },
]);
</script>

<template>
  <ContextMenu>
    <ContextMenuTrigger>
      <slot />
    </ContextMenuTrigger>
    <ContextMenuContent>
      <template v-for="item in menuItems" :key="item.label || 'separator'">
        <ContextMenuSeparator v-if="item.type === 'separator'" />
        <ContextMenuItem 
          v-else
          :disabled="item.disabled"
          @click="item.action"
        >
          {{ item.label }}
          <ContextMenuShortcut v-if="item.shortcut">
            {{ item.shortcut }}
          </ContextMenuShortcut>
        </ContextMenuItem>
      </template>
    </ContextMenuContent>
  </ContextMenu>
</template>
```

### 5.3 P3 - å›½é™…åŒ–æ”¯æŒ

#### 5.3.1 å¤šè¯­è¨€é…ç½®

**ä¾èµ–å…³ç³»**ï¼šç°æœ‰i18nç³»ç»Ÿ  
**å®æ–½ä¼˜å…ˆçº§**ï¼šä½  

```typescript
// i18n/locales/zh-CN/topMenu.json
{
  "search": {
    "placeholder": "æœç´¢é¡µé¢ã€è®¢å•ã€äº§å“...",
    "noResults": "æœªæ‰¾åˆ°ç›¸å…³ç»“æœ",
    "recentSearches": "æœ€è¿‘æœç´¢",
    "suggestions": "æœç´¢å»ºè®®",
    "shortcut": "Ctrl+K"
  },
  "tabs": {
    "close": "å…³é—­æ ‡ç­¾",
    "closeOthers": "å…³é—­å…¶ä»–æ ‡ç­¾",
    "closeAll": "å…³é—­æ‰€æœ‰æ ‡ç­¾",
    "newTab": "æ–°å»ºæ ‡ç­¾",
    "maxTabsReached": "å·²è¾¾åˆ°æœ€å¤§æ ‡ç­¾æ•°é‡é™åˆ¶"
  },
  "theme": {
    "light": "æµ…è‰²ä¸»é¢˜",
    "dark": "æ·±è‰²ä¸»é¢˜",
    "system": "è·Ÿéšç³»ç»Ÿ"
  },
  "user": {
    "profile": "ä¸ªäººèµ„æ–™",
    "settings": "è®¾ç½®",
    "logout": "é€€å‡ºç™»å½•"
  }
}
```

---

## ğŸ›¡ï¸ å…­ã€å®‰å…¨ä¸æ€§èƒ½

### 6.1 å®‰å…¨è€ƒè™‘

#### 6.1.1 è¾“å…¥éªŒè¯ä¸XSSé˜²æŠ¤

```typescript
// utils/topMenuSecurity.ts
export class TopMenuSecurity {
  // æœç´¢æŸ¥è¯¢æ¸…ç†
  static sanitizeSearchQuery(query: string): string {
    return query
      .replace(/[<>]/g, '') // ç§»é™¤HTMLæ ‡ç­¾
      .replace(/javascript:/gi, '') // ç§»é™¤JavaScriptåè®®
      .trim()
      .slice(0, 100); // é™åˆ¶é•¿åº¦
  }
  
  // Tab URLéªŒè¯
  static validateTabUrl(url: string): boolean {
    try {
      const urlObj = new URL(url, window.location.origin);
      
      // åªå…è®¸åŒæºURL
      if (urlObj.origin !== window.location.origin) {
        return false;
      }
      
      // æ£€æŸ¥è·¯å¾„ç™½åå•
      const allowedPaths = [
        '/dashboard',
        '/orders',
        '/products',
        '/customers',
        '/settings',
        '/reports',
      ];
      
      return allowedPaths.some(path => urlObj.pathname.startsWith(path));
    } catch {
      return false;
    }
  }
}
```

#### 6.1.2 æœç´¢é¢‘ç‡é™åˆ¶

```typescript
// æœç´¢é¢‘ç‡é™åˆ¶
const createSearchRateLimit = () => {
  const requests = new Map<string, number[]>();
  
  return (userId: string): boolean => {
    const now = Date.now();
    const userRequests = requests.get(userId) || [];
    
    // æ¸…ç†1åˆ†é’Ÿå‰çš„è¯·æ±‚
    const recentRequests = userRequests.filter(time => now - time < 60000);
    
    // é™åˆ¶æ¯åˆ†é’Ÿæœ€å¤š30æ¬¡æœç´¢
    if (recentRequests.length >= 30) {
      return false;
    }
    
    recentRequests.push(now);
    requests.set(userId, recentRequests);
    return true;
  };
};
```

### 6.2 æ€§èƒ½ä¼˜åŒ–

#### 6.2.1 ç»„ä»¶å»¶è¿ŸåŠ è½½

```typescript
// æŒ‰éœ€åŠ è½½é‡å‹ç»„ä»¶
const SearchDialog = defineAsyncComponent(() => import('@/components/SearchDialog.vue'));
const TabPreview = defineAsyncComponent(() => import('@/components/TabPreview.vue'));
```

#### 6.2.2 çŠ¶æ€æŒä¹…åŒ–

```typescript
// composables/useTopMenuPersistence.ts
export function useTopMenuPersistence() {
  const tabState = useLocalStorage('top-menu-tabs', {
    tabs: [] as TabItem[],
    activeTabId: null as string | null,
    settings: {
      maxTabs: 12,
      enableDragReorder: true,
    },
  });
  
  // å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
  const cleanupExpiredData = () => {
    const oneWeekAgo = Date.now() - 7 * 24 * 60 * 60 * 1000;
    
    tabState.value.tabs = tabState.value.tabs.filter(
      tab => (tab.lastAccessed || Date.now()) > oneWeekAgo
    );
  };
  
  onMounted(() => {
    cleanupExpiredData();
  });
  
  return {
    tabState,
    cleanupExpiredData,
  };
}
```

---

## ğŸ§ª ä¸ƒã€æµ‹è¯•ç­–ç•¥

### 7.1 å•å…ƒæµ‹è¯•

```typescript
// tests/unit/TabNavigation.test.ts
describe('TabNavigation', () => {
  it('åº”è¯¥èƒ½å¤Ÿæ·»åŠ æ–°æ ‡ç­¾é¡µ', () => {
    const { addTab, tabs } = useTabNavigation();
    
    addTab({
      title: 'æµ‹è¯•æ ‡ç­¾',
      href: '/test',
      isActive: false,
      isClosable: true,
    });
    
    expect(tabs.value).toHaveLength(1);
    expect(tabs.value[0].title).toBe('æµ‹è¯•æ ‡ç­¾');
  });
  
  it('åº”è¯¥é™åˆ¶æœ€å¤§æ ‡ç­¾é¡µæ•°é‡', () => {
    const { addTab, tabs, maxTabs } = useTabNavigation();
    maxTabs.value = 2;
    
    // æ·»åŠ 3ä¸ªæ ‡ç­¾é¡µ
    for (let i = 0; i < 3; i++) {
      addTab({
        title: `æ ‡ç­¾${i}`,
        href: `/test${i}`,
        isActive: false,
        isClosable: true,
      });
    }
    
    expect(tabs.value).toHaveLength(2);
  });
});
```

### 7.2 E2Eæµ‹è¯•

```typescript
// tests/e2e/topMenuBar.spec.ts
test('ç”¨æˆ·å¯ä»¥é€šè¿‡æœç´¢åŠŸèƒ½å¯¼èˆª', async ({ page }) => {
  await page.goto('/dashboard');
  
  // æ‰“å¼€æœç´¢
  await page.keyboard.press('Control+K');
  await expect(page.locator('[data-testid="search-dialog"]')).toBeVisible();
  
  // æœç´¢è®¢å•
  await page.fill('[data-testid="search-input"]', 'è®¢å•');
  await page.click('[data-testid="search-result-orders"]');
  
  // éªŒè¯å¯¼èˆªæˆåŠŸ
  await expect(page).toHaveURL('/orders');
  
  // éªŒè¯Tabå·²æ·»åŠ 
  await expect(page.locator('[data-testid="tab-orders"]')).toBeVisible();
});
```

---

## ğŸ“¦ å…«ã€å®æ–½è®¡åˆ’

### 8.1 å¼€å‘é˜¶æ®µåˆ’åˆ†

#### é˜¶æ®µä¸€ï¼šåŸºç¡€æ¶æ„ï¼ˆ2-3å¤©ï¼‰
**ç›®æ ‡**ï¼šå»ºç«‹æ ¸å¿ƒç»„ä»¶å’ŒåŸºç¡€å¸ƒå±€

- [ ] åˆ›å»ºTopMenuBarä¸»ç»„ä»¶
- [ ] é‡æ„ç°æœ‰AppHeaderç»„ä»¶
- [ ] é›†æˆSidebarTriggerå’Œç°æœ‰å·¥å…·ç»„ä»¶
- [ ] å»ºç«‹åŸºç¡€æ ·å¼å’Œå“åº”å¼å¸ƒå±€

**äº¤ä»˜ç‰©**ï¼š
- TopMenuBar.vueç»„ä»¶
- åŸºç¡€æ ·å¼æ–‡ä»¶
- å“åº”å¼å¸ƒå±€æµ‹è¯•

#### é˜¶æ®µäºŒï¼šæœç´¢åŠŸèƒ½ï¼ˆ2-3å¤©ï¼‰
**ç›®æ ‡**ï¼šå®ç°åŸºç¡€æœç´¢åŠŸèƒ½

- [ ] å¼€å‘SearchBarç»„ä»¶
- [ ] å®ç°åŸºç¡€æœç´¢é€»è¾‘
- [ ] æ·»åŠ å¿«æ·é”®æ”¯æŒ
- [ ] é›†æˆæƒé™æ§åˆ¶

**äº¤ä»˜ç‰©**ï¼š
- SearchBar.vueç»„ä»¶
- useGlobalSearch composable
- æœç´¢APIæ¥å£

#### é˜¶æ®µä¸‰ï¼šTabå¯¼èˆªï¼ˆ3-4å¤©ï¼‰
**ç›®æ ‡**ï¼šå®ç°Tabå¯¼èˆªæ ¸å¿ƒåŠŸèƒ½

- [ ] å¼€å‘Tabå¯¼èˆªç»„ä»¶åº“
- [ ] å®ç°TabçŠ¶æ€ç®¡ç†
- [ ] é›†æˆInertia.jsè·¯ç”±
- [ ] æ·»åŠ åŸºç¡€äº¤äº’åŠŸèƒ½

**äº¤ä»˜ç‰©**ï¼š
- TabNavigationç»„ä»¶åº“
- useTabNavigation composable
- è·¯ç”±é›†æˆé€»è¾‘

#### é˜¶æ®µå››ï¼šåŠŸèƒ½å®Œå–„ï¼ˆ2-3å¤©ï¼‰
**ç›®æ ‡**ï¼šæ·»åŠ é«˜çº§åŠŸèƒ½å’Œä¼˜åŒ–

- [ ] å®ç°Tabæ‹–æ‹½é‡æ’åº
- [ ] æ·»åŠ å³é”®èœå•
- [ ] å®Œå–„æœç´¢åŠŸèƒ½
- [ ] æ€§èƒ½ä¼˜åŒ–

**äº¤ä»˜ç‰©**ï¼š
- å®Œæ•´åŠŸèƒ½ç»„ä»¶
- æ€§èƒ½ä¼˜åŒ–æŠ¥å‘Š
- ç”¨æˆ·ä½“éªŒæµ‹è¯•

#### é˜¶æ®µäº”ï¼šæµ‹è¯•ä¸éƒ¨ç½²ï¼ˆ1-2å¤©ï¼‰
**ç›®æ ‡**ï¼šç¡®ä¿è´¨é‡å’Œç¨³å®šæ€§

- [ ] å•å…ƒæµ‹è¯•ç¼–å†™
- [ ] E2Eæµ‹è¯•ç¼–å†™
- [ ] æ— éšœç¢åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•

**äº¤ä»˜ç‰©**ï¼š
- å®Œæ•´æµ‹è¯•å¥—ä»¶
- éƒ¨ç½²æ–‡æ¡£
- ç”¨æˆ·æ‰‹å†Œ

### 8.2 é‡Œç¨‹ç¢‘æ£€æŸ¥ç‚¹

| é‡Œç¨‹ç¢‘ | æ—¶é—´ç‚¹ | æ£€æŸ¥å†…å®¹ | æˆåŠŸæ ‡å‡† |
|--------|--------|----------|----------|
| M1 | ç¬¬3å¤© | åŸºç¡€å¸ƒå±€å®Œæˆ | é¡¶éƒ¨èœå•æ æ­£å¸¸æ˜¾ç¤ºï¼Œå“åº”å¼å¸ƒå±€å·¥ä½œ |
| M2 | ç¬¬6å¤© | æœç´¢åŠŸèƒ½å¯ç”¨ | æœç´¢åŠŸèƒ½æ­£å¸¸ï¼Œå¿«æ·é”®å·¥ä½œ |
| M3 | ç¬¬10å¤© | Tabå¯¼èˆªå®Œæˆ | Tabæ·»åŠ /å…³é—­/åˆ‡æ¢åŠŸèƒ½æ­£å¸¸ |
| M4 | ç¬¬13å¤© | åŠŸèƒ½å®Œå–„ | æ‰€æœ‰é«˜çº§åŠŸèƒ½å·¥ä½œæ­£å¸¸ |
| M5 | ç¬¬15å¤© | æµ‹è¯•å®Œæˆ | æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œæ€§èƒ½è¾¾æ ‡ |

---

## âœ… ä¹ã€éªŒæ”¶æ ‡å‡†

### 9.1 åŠŸèƒ½å®Œæ•´æ€§

#### æ ¸å¿ƒåŠŸèƒ½
- [ ] é¡¶éƒ¨èœå•æ æ­£ç¡®æ˜¾ç¤ºå’Œå¸ƒå±€
- [ ] ä¾§è¾¹æ å±•å¼€/æ”¶èµ·æŒ‰é’®æ­£å¸¸å·¥ä½œ
- [ ] æœç´¢æ æ”¯æŒå¿«æ·é”®æ‰“å¼€å’Œå…¨å±€æœç´¢
- [ ] è¯­è¨€åˆ‡æ¢å™¨é›†æˆå¹¶ç®€åŒ–æ˜¾ç¤º
- [ ] ä¸»é¢˜åˆ‡æ¢å™¨æ”¯æŒä¸€é”®åˆ‡æ¢
- [ ] ç”¨æˆ·èœå•ä¿æŒç°æœ‰åŠŸèƒ½

#### Tabå¯¼èˆªåŠŸèƒ½
- [ ] Tabå¯¼èˆªæ”¯æŒæ·»åŠ ã€å…³é—­ã€åˆ‡æ¢
- [ ] Tabé‡æ’åºåŠŸèƒ½æ­£å¸¸
- [ ] Tabå³é”®èœå•åŠŸèƒ½å®Œæ•´
- [ ] Tabæ•°é‡é™åˆ¶æœºåˆ¶å·¥ä½œ
- [ ] TabçŠ¶æ€æŒä¹…åŒ–æ­£å¸¸

#### æƒé™æ§åˆ¶
- [ ] æœç´¢åŠŸèƒ½æ ¹æ®æƒé™æ˜¾ç¤º/éšè—
- [ ] æ¨¡å—è®¿é—®æƒé™æ­£ç¡®è¿‡æ»¤
- [ ] å›¢é˜Ÿåˆ‡æ¢æ—¶æƒé™æ­£ç¡®æ›´æ–°

### 9.2 æ€§èƒ½æ ‡å‡†

- [ ] é¦–æ¬¡åŠ è½½æ—¶é—´ä¸è¶…è¿‡å½“å‰ç‰ˆæœ¬çš„110%
- [ ] Tabåˆ‡æ¢å“åº”æ—¶é—´å°äº100ms
- [ ] æœç´¢å“åº”æ—¶é—´å°äº300ms
- [ ] å†…å­˜ä½¿ç”¨é‡åœ¨åˆç†èŒƒå›´å†…
- [ ] æ— å†…å­˜æ³„æ¼é—®é¢˜

### 9.3 ç”¨æˆ·ä½“éªŒ

- [ ] æ‰€æœ‰å¿«æ·é”®åŠŸèƒ½æ­£å¸¸
- [ ] åŠ¨ç”»æ•ˆæœæµç•…è‡ªç„¶
- [ ] æ— éšœç¢åŠŸèƒ½å®Œå¤‡
- [ ] å¤šè¯­è¨€æ”¯æŒæ­£å¸¸
- [ ] ä¸»é¢˜åˆ‡æ¢æ— é—ªçƒ

### 9.4 å…¼å®¹æ€§

- [ ] æ”¯æŒChromeã€Firefoxã€Safariã€Edgeæœ€æ–°ç‰ˆæœ¬
- [ ] ç§»åŠ¨ç«¯Safariå’ŒChromeæ­£å¸¸æ˜¾ç¤º
- [ ] è§¦æ‘¸è®¾å¤‡äº¤äº’æ­£å¸¸
- [ ] é”®ç›˜å¯¼èˆªå®Œæ•´æ”¯æŒ

### 9.5 å®‰å…¨æ€§

- [ ] æœç´¢è¾“å…¥æ­£ç¡®æ¸…ç†å’ŒéªŒè¯
- [ ] Tab URLéªŒè¯æœºåˆ¶å·¥ä½œ
- [ ] æƒé™æ£€æŸ¥æ— ç»•è¿‡æ¼æ´
- [ ] æ— XSSå®‰å…¨é£é™©

---

## âš ï¸ åã€é£é™©è¯„ä¼°ä¸ç¼“è§£

### 10.1 æŠ€æœ¯é£é™©

| é£é™©é¡¹ | å½±å“ç¨‹åº¦ | å‘ç”Ÿæ¦‚ç‡ | ç¼“è§£ç­–ç•¥ |
|--------|----------|----------|----------|
| Tabå¯¼èˆªå†…å­˜æ³„æ¼ | é«˜ | ä¸­ | å®æ–½ä¸¥æ ¼çš„Tabæ•°é‡é™åˆ¶å’Œè‡ªåŠ¨æ¸…ç†æœºåˆ¶ |
| æœç´¢æ€§èƒ½é—®é¢˜ | ä¸­ | ä¸­ | å®æ–½é˜²æŠ–ã€ç¼“å­˜å’Œåˆ†é¡µç­–ç•¥ |
| æƒé™æ£€æŸ¥å¤±æ•ˆ | é«˜ | ä½ | å¤šå±‚æƒé™éªŒè¯å’Œé™çº§æ–¹æ¡ˆ |
| æµè§ˆå™¨å…¼å®¹æ€§ | ä¸­ | ä½ | æ¸è¿›å¼å¢å¼ºå’Œpolyfillæ”¯æŒ |
| Inertia.jsé›†æˆé—®é¢˜ | ä¸­ | ä¸­ | å……åˆ†æµ‹è¯•è·¯ç”±çŠ¶æ€ç®¡ç† |

### 10.2 ç”¨æˆ·ä½“éªŒé£é™©

| é£é™©é¡¹ | å½±å“ç¨‹åº¦ | å‘ç”Ÿæ¦‚ç‡ | ç¼“è§£ç­–ç•¥ |
|--------|----------|----------|----------|
| å­¦ä¹ æˆæœ¬è¿‡é«˜ | ä¸­ | ä¸­ | æä¾›å¼•å¯¼æ•™ç¨‹å’Œå¸®åŠ©æ–‡æ¡£ |
| æ“ä½œå¤æ‚åº¦å¢åŠ  | ä¸­ | ä¸­ | ä¿æŒç®€æ´çš„é»˜è®¤çŠ¶æ€ï¼Œé«˜çº§åŠŸèƒ½å¯é€‰ |
| ç§»åŠ¨ç«¯ä½“éªŒå·® | é«˜ | ä¸­ | å“åº”å¼è®¾è®¡å’Œè§¦æ‘¸ä¼˜åŒ– |
| åŠŸèƒ½å‘ç°æ€§å·® | ä¸­ | ä¸­ | æ˜ç¡®çš„è§†è§‰æç¤ºå’Œå¿«æ·é”®æ˜¾ç¤º |

### 10.3 ä¸šåŠ¡é£é™©

| é£é™©é¡¹ | å½±å“ç¨‹åº¦ | å‘ç”Ÿæ¦‚ç‡ | ç¼“è§£ç­–ç•¥ |
|--------|----------|----------|----------|
| å¼€å‘å‘¨æœŸå»¶é•¿ | ä¸­ | ä¸­ | åˆ†é˜¶æ®µå®æ–½ï¼Œæ ¸å¿ƒåŠŸèƒ½ä¼˜å…ˆ |
| ç»´æŠ¤æˆæœ¬å¢åŠ  | ä¸­ | é«˜ | å®Œå–„çš„æ–‡æ¡£å’Œæµ‹è¯•è¦†ç›– |
| ç”¨æˆ·æ¥å—åº¦ä½ | é«˜ | ä½ | ç”¨æˆ·æµ‹è¯•å’Œåé¦ˆæ”¶é›† |
| ç°æœ‰åŠŸèƒ½å›å½’ | é«˜ | ä½ | å……åˆ†çš„å›å½’æµ‹è¯• |

---

## ğŸ”® åä¸€ã€åç»­ä¼˜åŒ–æ–¹å‘

### 11.1 çŸ­æœŸä¼˜åŒ–ï¼ˆ1-3ä¸ªæœˆï¼‰
- æ”¶é›†ç”¨æˆ·ä½¿ç”¨æ•°æ®å’Œåé¦ˆ
- ä¼˜åŒ–æœç´¢ç®—æ³•å’Œç»“æœæ’åº
- å®Œå–„ç§»åŠ¨ç«¯ä½“éªŒ
- å¢åŠ æ›´å¤šå¿«æ·é”®æ”¯æŒ
- æ·»åŠ ä½¿ç”¨ç»Ÿè®¡å’Œåˆ†æ

### 11.2 ä¸­æœŸä¼˜åŒ–ï¼ˆ3-6ä¸ªæœˆï¼‰
- å®æ–½AIé©±åŠ¨çš„æ™ºèƒ½æœç´¢å»ºè®®
- æ·»åŠ Tabé¢„è§ˆå’Œç¼©ç•¥å›¾åŠŸèƒ½
- é›†æˆå·¥ä½œæµç¨‹å¿«æ·æ“ä½œ
- æ”¯æŒè‡ªå®šä¹‰å·¥å…·æ å¸ƒå±€
- æ·»åŠ æœç´¢ç»“æœæ’åºå’Œè¿‡æ»¤

### 11.3 é•¿æœŸä¼˜åŒ–ï¼ˆ6-12ä¸ªæœˆï¼‰
- å®ç°è·¨è®¾å¤‡TabåŒæ­¥
- æ·»åŠ è¯­éŸ³æœç´¢åŠŸèƒ½
- é›†æˆç¬¬ä¸‰æ–¹åº”ç”¨å’Œæ’ä»¶
- æ”¯æŒä¸ªæ€§åŒ–æ¨èå’Œæ™ºèƒ½åŠ©æ‰‹
- å®ç°åä½œåŠŸèƒ½ï¼ˆå…±äº«Tabç­‰ï¼‰

---

## ğŸ“š åäºŒã€é™„å½•

### 12.1 ä¾èµ–å…³ç³»å›¾

```mermaid
graph TD
    A[åŸºç¡€å¸ƒå±€] --> B[æœç´¢åŠŸèƒ½]
    A --> C[Tabå¯¼èˆª]
    D[æƒé™ç³»ç»Ÿ] --> B
    D --> C
    E[Inertia.js] --> C
    F[ç°æœ‰ç»„ä»¶] --> A
    B --> G[é«˜çº§æœç´¢]
    C --> H[Tabå¢å¼ºåŠŸèƒ½]
    I[å›½é™…åŒ–] --> B
    I --> C
```

### 12.2 ç»„ä»¶ä¾èµ–å…³ç³»

```typescript
// ç»„ä»¶ä¾èµ–å±‚æ¬¡
TopMenuBar
â”œâ”€â”€ SidebarTrigger (ç°æœ‰)
â”œâ”€â”€ SearchBar
â”‚   â”œâ”€â”€ useGlobalSearch
â”‚   â”œâ”€â”€ useTopMenuPermissions
â”‚   â””â”€â”€ CommandDialog (reka-ui)
â”œâ”€â”€ LanguageToggle (ç®€åŒ–ç‰ˆLanguageSwitcher)
â”œâ”€â”€ ThemeToggle (ç®€åŒ–ç‰ˆAppearanceTabs)
â”œâ”€â”€ UserMenu (ç°æœ‰UserMenuContent)
â””â”€â”€ TabNavigation
    â”œâ”€â”€ useTabNavigation
    â”œâ”€â”€ useInertiaTabNavigation
    â”œâ”€â”€ TabItem
    â”œâ”€â”€ TabContextMenu
    â””â”€â”€ TabDragHandler
```

### 12.3 ç¯å¢ƒå˜é‡é…ç½®

```env
# .env
# æœç´¢åŠŸèƒ½é…ç½®
VITE_SEARCH_ENABLED=true
VITE_SEARCH_CACHE_TTL=30
VITE_MAX_SEARCH_RESULTS=10

# Tabå¯¼èˆªé…ç½®
VITE_MAX_TABS=12
VITE_TAB_PERSISTENCE=true
VITE_TAB_DRAG_ENABLED=true

# æ€§èƒ½é…ç½®
VITE_SEARCH_DEBOUNCE_MS=300
VITE_TAB_CLEANUP_INTERVAL=86400000
```

### 12.4 æ„å»ºä¼˜åŒ–é…ç½®

```typescript
// vite.config.ts
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        manualChunks: {
          'top-menu': [
            '@/components/TopMenuBar.vue',
            '@/components/SearchBar.vue',
            '@/components/TabNavigation'
          ],
          'search': [
            '@/composables/useGlobalSearch.ts',
            '@/composables/useAdvancedSearch.ts'
          ],
          'tabs': [
            '@/composables/useTabNavigation.ts',
            '@/composables/useInertiaTabNavigation.ts'
          ],
        },
      },
    },
  },
});
```

---

**æ€»é¢„ä¼°å·¥æœŸï¼š10-15å¤©**  
**æ ¸å¿ƒåŠŸèƒ½å®Œæˆï¼š8-10å¤©**  
**å®Œæ•´åŠŸèƒ½äº¤ä»˜ï¼š10-15å¤©**

å¦‚éœ€è¿›ä¸€æ­¥ç»†åŒ–ç‰¹å®šåŠŸèƒ½çš„å®ç°æ–¹æ¡ˆï¼Œè¯·æ ¹æ®å®é™…å¼€å‘è¿›åº¦å’Œéœ€æ±‚ä¼˜å…ˆçº§è¿›è¡Œè°ƒæ•´ã€‚

## åŠ¨æ€æ ‡ç­¾é¡µç³»ç»Ÿä½¿ç”¨æŒ‡å—

### 1. ç³»ç»Ÿä¼˜å…ˆçº§

åŠ¨æ€æ ‡ç­¾é¡µç³»ç»ŸæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§è·å–é¡µé¢ä¿¡æ¯ï¼š

1. **é¡µé¢ Props ä¸­çš„ meta ä¿¡æ¯**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
2. **ç»„ä»¶åç§°æ¨å¯¼**
3. **URL è·¯å¾„åŠ¨æ€ç”Ÿæˆ**ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰

### 2. åœ¨åç«¯è·¯ç”±ä¸­å®šä¹‰ Meta ä¿¡æ¯

```php
// routes/web.php æˆ– routes/settings.php
Route::get('dashboard', function () {
    return Inertia::render('Dashboard', [
        'meta' => [
            'title' => 'ä»ªè¡¨æ¿',      // æ ‡ç­¾é¡µæ ‡é¢˜
            'icon' => 'ğŸ“Š',          // æ ‡ç­¾é¡µå›¾æ ‡
            'closable' => false,     // æ˜¯å¦å¯å…³é—­
        ]
    ]);
})->name('dashboard');

Route::get('settings/profile', function () {
    return Inertia::render('settings/Profile', [
        'meta' => [
            'title' => 'ä¸ªäººèµ„æ–™',
            'icon' => 'ğŸ‘¤',
            'closable' => true,
        ]
    ]);
})->name('profile.edit');
```

### 3. åœ¨é¡µé¢ç»„ä»¶ä¸­å®šä¹‰ Meta ä¿¡æ¯

```vue
<script setup lang="ts">
// å®šä¹‰é¡µé¢ Props æ¥å£
interface Props {
    meta?: {
        title?: string;
        icon?: string;
        closable?: boolean;
    };
}

// è®¾ç½®é»˜è®¤å€¼ï¼ˆwithDefaults æ˜¯ç¼–è¯‘å™¨å®ï¼Œæ— éœ€å¯¼å…¥ï¼‰
const props = withDefaults(defineProps<Props>(), {
    meta: () => ({
        title: 'é»˜è®¤æ ‡é¢˜',
        icon: 'ğŸ“„',
        closable: true
    })
});
</script>
```

### 4. ç»„ä»¶åç§°è‡ªåŠ¨æ¨å¯¼

å¦‚æœæ²¡æœ‰æä¾› meta ä¿¡æ¯ï¼Œç³»ç»Ÿä¼šæ ¹æ®ç»„ä»¶åç§°è‡ªåŠ¨æ¨å¯¼ï¼š

- `Dashboard` â†’ "ä»ªè¡¨æ¿" ğŸ“Š
- `settings/Profile` â†’ "ä¸ªäººèµ„æ–™" ğŸ‘¤
- `settings/Password` â†’ "å¯†ç è®¾ç½®" ğŸ”’
- `UserManagement` â†’ "User Management" ğŸ‘¥

### 5. URL è·¯å¾„è‡ªåŠ¨ç”Ÿæˆ

ä½œä¸ºæœ€åçš„å›é€€ï¼Œç³»ç»Ÿä¼šä» URL è·¯å¾„è‡ªåŠ¨ç”Ÿæˆæ ‡é¢˜ï¼š

- `/settings/profile` â†’ "ä¸ªäººèµ„æ–™" ğŸ‘¤
- `/user-management` â†’ "User Management" ğŸ‘¥
- `/reports/sales` â†’ "Sales" ğŸ“ˆ

### 6. åŠ¨æ€æ›´æ–°æ ‡ç­¾é¡µä¿¡æ¯

```typescript
import { useTabNavigation } from '@/composables/useTabNavigation';

const { updateTabInfo, activeTabId } = useTabNavigation();

// åœ¨é¡µé¢ç»„ä»¶ä¸­åŠ¨æ€æ›´æ–°å½“å‰æ ‡ç­¾é¡µ
const updateCurrentTab = () => {
    updateTabInfo(activeTabId.value, {
        title: 'æ–°æ ‡é¢˜',
        icon: 'ğŸ”„'
    });
};
```

### 7. æ”¯æŒçš„å›¾æ ‡å…³é”®è¯

ç³»ç»Ÿæ”¯æŒæ ¹æ®ç»„ä»¶åç§°å’Œè·¯å¾„è‡ªåŠ¨åŒ¹é…å›¾æ ‡ï¼š

- `Dashboard` â†’ ğŸ“Š
- `Profile`, `User` â†’ ğŸ‘¤
- `Password`, `Security` â†’ ğŸ”’
- `Appearance`, `Theme` â†’ ğŸ¨
- `Settings` â†’ âš™ï¸
- `Test` â†’ ğŸ”§
- `Demo` â†’ ğŸ§ª
- `Report`, `Chart` â†’ ğŸ“ˆ
- `Form` â†’ ğŸ“
- `List`, `Table` â†’ ğŸ“‹

### 8. æ‰©å±•æ€§

è¦æ·»åŠ æ–°çš„è‡ªåŠ¨è¯†åˆ«è§„åˆ™ï¼Œåªéœ€ä¿®æ”¹ `useTabNavigation.ts` ä¸­çš„æ˜ å°„å¯¹è±¡ï¼š

```typescript
// ç»„ä»¶æ˜ å°„
const componentMap: Record<string, { title: string; icon?: string }> = {
    'YourComponent': { title: 'ä½ çš„ç»„ä»¶', icon: 'ğŸš€' },
    // æ·»åŠ æ›´å¤šæ˜ å°„...
};

// å›¾æ ‡æ˜ å°„
const iconMap: Record<string, string> = {
    'YourKeyword': 'ğŸš€',
    // æ·»åŠ æ›´å¤šå›¾æ ‡...
};
```

è¿™ä¸ªåŠ¨æ€ç³»ç»Ÿç¡®ä¿äº†ï¼š
- ğŸ¯ **çµæ´»æ€§**ï¼šæ”¯æŒå¤šç§å®šä¹‰æ–¹å¼
- ğŸ”„ **è‡ªåŠ¨åŒ–**ï¼šæ— éœ€æ‰‹åŠ¨é…ç½®å³å¯å·¥ä½œ
- ğŸ› ï¸ **å¯æ‰©å±•**ï¼šå®¹æ˜“æ·»åŠ æ–°çš„è¯†åˆ«è§„åˆ™
- ğŸ“± **ä¸€è‡´æ€§**ï¼šæ‰€æœ‰é¡µé¢éƒ½æœ‰åˆé€‚çš„æ ‡é¢˜å’Œå›¾æ ‡